<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Riley Kidd - Malware – The game of cat and mouse</title>
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/css/lightbox.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/assets/css/all.css">
  <link rel="alternate" type="application/atom+xml" title="Riley Kidd" href="https://rileykidd.com/atom.xml" />
</head>
<body>
  <div class="container">
    <div class="three columns sidebar">
      <nav>
  <h2 id="banner"><a href="/">Riley Kidd</a></h2>
  <div id="bio">
    <p>Security from a different perspective</p>
  </div>
  <div id="social">
    <div id="stalker">
  
  
  <a title="LinkedIn" href="https://www.linkedin.com/in/rileykidd">
    <i class="fa fa-linkedin-square"></i>
  </a>
  
  
  <a title="Send an email" href="mailto:rileykidd@protonmail.com">
    <i class="fa fa-envelope-square"></i>
  </a>
  
  
  <a title="Atom feed" id="atom" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>
</nav>

    </div>
    <div class="nine columns content">
      <h1 class="title">Malware – The game of cat and mouse</h1>
<p class="meta">
  June 17, 2013
</p>
<div id="post">
  <p>Malware writers and malware researchers play a constant game of cat and mouse - one where the former consistently have the upper hand.</p>

<p>While there is some overlap, malware evasion techniques can be broadly categorised into 3 main areas with 3 main goals:</p>

<ul>
  <li><strong>Egress bypass (Exfiltrate)</strong> – bypass controls to communicate to an external command and control (C&amp;C) server, to pull new commands and push data</li>
  <li><strong>Researcher bypass (Stall)</strong> – slow down methods to reverse engineer and defend against malware, extending the window where the malware can exist in the wild</li>
  <li><strong>User bypass (Persist)</strong> – bypass user based controls such as anti-virus (AV), operating system (OS) controls or generally evading the user to avoid detection</li>
</ul>

<p>These categories can be broken down into specific sub-components:</p>

<p><strong>Egress bypass (Exfiltrate)</strong></p>

<ul>
  <li><strong>Script fragmentation</strong> – request commands in small chunks as opposed to one larger request</li>
  <li><strong>HTTP pull</strong> – pulling a resource from some innocent domain – such as a legitimate image file which contains an encoded payload</li>
  <li><strong>HTTP DNS resolution</strong> – resolving DNS information via some http service – such as extracting no-ip domain information from some HTTP based DNS resolver</li>
  <li><strong>Peer-2-Peer (P2P) push/pull</strong> – Communicating via an inter-malware network using trust algorithms to push/pull commands and data</li>
  <li><strong>Encrypted/obfuscated protocols</strong> – Using either standardised or proprietary encryption methods to communicate via a secure channel</li>
  <li><strong>Hooking Application Programming Interface (API) calls</strong> – injecting into trusted processes such as web browsers to make requests</li>
</ul>

<p><strong>Researcher bypass (Stall)</strong></p>

<ul>
  <li><strong>Anti-Virtual Machine (VM)/debugging/disassembly techniques</strong> – applying techniques which cause the malware to change its behaviour in a VM or refuse to open in a debugger</li>
  <li><strong>Domain Generation Algorithms (DGA) with misleading call backs</strong> – utilising a DGA to potentially poll 10k domains across 15 top level domains (TLDs) where only one is required to give valid information or others reply with deceiving data</li>
  <li><strong>Obfuscated code</strong> – standard stalling technique</li>
</ul>

<p><strong>User bypass (Persist)</strong></p>

<ul>
  <li><strong>Server/Client polymorphic algorithms to bypass signatures</strong> – using polymorphic algorithms to mutate code areas to bypass AV signatures and heuristics</li>
  <li><strong>Direct hardware access</strong> – bypass, change or piggyback OS controls by modifying the behaviour of core parts of the OS, particularly aiming to infect into kernel mode (Ring 0)</li>
  <li><strong>Sleeping</strong> – once infecting a machine sleeping for some predetermined amount of time</li>
  <li><strong>Man in the Browser (MitB)/Web Injects/Session Redirection</strong> – Injecting javascript into legitimate pages to discretely steal session information from trusted websites</li>
  <li><strong>Digitally Signed</strong> – using legitimate stolen encryption certificates to sign malware as whitelisted/trusted software</li>
</ul>

</div>
<div id="related">
  <h3>Recent Posts</h3>
  <ul id="blog-posts" class="posts">
    
    <li>
      <span>08 Jul 2018</span> <a href="/2018/07/08/solving-CTF-challenges-with-DLL-injection/">Solving CTF challenges with DLL injection</a>
    </li>
    
    <li>
      <span>17 Oct 2017</span> <a href="/2017/10/17/a-watering-hole-with-Windows-binaries/">A watering hole with Windows binaries</a>
    </li>
    
    <li>
      <span>03 Aug 2017</span> <a href="/2017/08/03/application-whitelist-bypass-using-XLL-and-embedded-shellcode/">Application whitelist bypass using XLL and embedded shellcode</a>
    </li>
    
  </ul>
</div>

      <div class="footer">
        <div class="disclaimer">
  
  <p>
    The postings on this site are my own and don't represent my employer
  </p>
  
</div>

      </div>
    </div>
  </div>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox-plus-jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>
<!--
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-41399516-1', 'auto');
    ga('send', 'pageview');
  </script>
-->
</body>
</html>
